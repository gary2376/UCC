{% extends 'admin/index.html' %}
{% load static %}

{% block content %}
<div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 10px; margin-bottom: 20px; color: white;">
    <h2 style="margin: 0 0 15px 0; color: white;">
        <i class="fas fa-tachometer-alt"></i> ç³»çµ±å¿«é€Ÿå…¥å£
    </h2>
    <div style="display: flex; gap: 15px; flex-wrap: wrap;">
        <a href="#/erp/" style="background: rgba(255,255,255,0.2); padding: 15px 25px; border-radius: 8px; color: white; text-decoration: none; display: inline-flex; align-items: center; gap: 10px; min-width: 200px; transition: all 0.3s;">
            <i class="fas fa-chart-line fa-2x"></i>
            <div>
                <div style="font-weight: bold; font-size: 16px;">ERP ç³»çµ±</div>
                <div style="font-size: 12px; opacity: 0.8;">ä¼æ¥­è³‡æºè¦åŠƒç³»çµ±</div>
            </div>
        </a>
        
        <!-- ä¸»è¦çš„ERPæ¬Šé™ç®¡ç†ä¸­å¿ƒ -->
        <a href="#/admin/erp/permissions/" style="background: linear-gradient(45deg, #ff6b6b, #ee5a24); padding: 15px 25px; border-radius: 8px; color: white; text-decoration: none; display: inline-flex; align-items: center; gap: 10px; min-width: 200px; transition: all 0.3s; border: 2px solid rgba(255,255,255,0.3);">
            <i class="fas fa-shield-alt fa-2x"></i>
            <div>
                <div style="font-weight: bold; font-size: 16px;">ğŸ” ERPæ¬Šé™ç®¡ç†</div>
                <div style="font-size: 12px; opacity: 0.9;">ç¾¤çµ„ãƒ»æ¬Šé™ãƒ»ä½¿ç”¨è€…ç®¡ç†</div>
            </div>
        </a>
        
        <a href="#/admin/auth/group/" style="background: rgba(255,255,255,0.2); padding: 15px 25px; border-radius: 8px; color: white; text-decoration: none; display: inline-flex; align-items: center; gap: 10px; min-width: 200px; transition: all 0.3s;">
            <i class="fas fa-users fa-2x"></i>
            <div>
                <div style="font-weight: bold; font-size: 16px;">æŸ¥çœ‹æ‰€æœ‰ç¾¤çµ„</div>
                <div style="font-size: 12px; opacity: 0.8;">Djangoç¾¤çµ„ç®¡ç†</div>
            </div>
        </a>
        
        <a href="#/admin/auth/group/add/" style="background: rgba(255,255,255,0.2); padding: 15px 25px; border-radius: 8px; color: white; text-decoration: none; display: inline-flex; align-items: center; gap: 10px; min-width: 200px; transition: all 0.3s;">
            <i class="fas fa-plus-circle fa-2x"></i>
            <div>
                <div style="font-weight: bold; font-size: 16px;">å‰µå»ºæ–°ç¾¤çµ„</div>
                <div style="font-size: 12px; opacity: 0.8;">æ–°å¢æ¬Šé™ç¾¤çµ„</div>
            </div>
        </a>
        
        <a href="#/admin/erp/create-sample-groups/" style="background: rgba(255,255,255,0.2); padding: 15px 25px; border-radius: 8px; color: white; text-decoration: none; display: inline-flex; align-items: center; gap: 10px; min-width: 200px; transition: all 0.3s;">
            <i class="fas fa-magic fa-2x"></i>
            <div>
                <div style="font-weight: bold; font-size: 16px;">å‰µå»ºç¤ºç¯„ç¾¤çµ„</div>
                <div style="font-size: 12px; opacity: 0.8;">å¿«é€Ÿè¨­å®šç¯„ä¾‹</div>
            </div>
        </a>
    </div>
</div>

<style>
a[href^="/erp/"]:hover {
    background: rgba(255,255,255,0.3) !important;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}
</style>

<!-- è‡ªå®šç¾©æœ€è¿‘å‹•ä½œå€å¡Š -->
<div style="margin-top: 20px; display: flex; gap: 20px;">
    <div style="flex: 1; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); overflow: hidden;">
        <div style="background: #f8f9fa; padding: 15px; border-bottom: 1px solid #dee2e6;">
            <h3 style="margin: 0; font-size: 18px; font-weight: 600;">
                <i class="fas fa-history"></i> æœ€è¿‘çš„ç”¨æˆ¶æ´»å‹•
            </h3>
        </div>
        <div style="padding: 15px;">
            {% load erp_tags %}
            {% get_recent_activities as recent_activities %}
            {% if recent_activities %}
                <div style="max-height: 400px; overflow-y: auto;">
                    {% for activity in recent_activities %}
                    <div style="padding: 10px 0; border-bottom: 1px solid #f0f0f0; display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <div style="font-weight: bold; color: #333;">{{ activity.user.username }}</div>
                            <div style="font-size: 14px; color: #666; margin-top: 4px;">{{ activity.description }}</div>
                        </div>
                        <div style="background: #007bff; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px;">
                            {{ activity.created_at|date:"m/d H:i" }}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <div style="margin-top: 15px;">
                    <a href="/erp/activity-log/" style="background: #007bff; color: white; padding: 8px 16px; border-radius: 4px; text-decoration: none; font-size: 14px;">
                        <i class="fas fa-external-link-alt"></i> æŸ¥çœ‹æ‰€æœ‰æ´»å‹•è¨˜éŒ„
                    </a>
                </div>
            {% else %}
                <p style="color: #666; text-align: center; margin: 40px 0;">æš«ç„¡æœ€è¿‘çš„æ´»å‹•è¨˜éŒ„</p>
            {% endif %}
        </div>
    </div>
    <div style="flex: 1;">
        {{ block.super }}
    </div>
</div>
{% endblock %}

{% block head %}
  {{ block.super }}
  <link rel="stylesheet" href="{% static 'admin/fontawesome/css/all.min.css' %}">
  <link rel="apple-touch-icon" sizes="180x180" href="{% static 'admin/img/apple-touch-icon.png' %}">
  <link rel="icon" type="image/png" sizes="32x32" href="{% static 'admin/img/favicon-32x32.png' %}">
  <link rel="icon" type="image/png" sizes="16x16" href="{% static 'admin/img/favicon-16x16.png' %}">
  <link rel="mask-icon" href="{% static 'admin/img/safari-pinned-tab.svg' %}" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <style>
    {# ä¿®æ­£ sidebar ç¸®åˆæ™‚ï¼Œtooltip æ–‡å­—ç„¡æ³•é¡¯ç¤ºçš„å•é¡Œ #}
    .el-tooltip__popper span {
      display: block !important;
    }

    {# badge style from Bootstrap 5.1 #}
    .badge {
      display: inline-block;
      padding: .35em .65em;
      font-size: .3rem !important;
      font-weight: 700;
      line-height: 1;
      color: #fff;
      text-align: center;
      white-space: nowrap;
      vertical-align: baseline;
      border-radius: .25rem;
    }

    .bg-danger {
      --bs-bg-opacity: 1;
      --bs-danger-rgb: 220, 53, 69;
      background-color: rgba(var(--bs-danger-rgb), var(--bs-bg-opacity)) !important;
    }
  </style>
{% endblock %}

{% block logo %}
  <div class="logo-wrap" v-if="!fold">
    <div class="float-wrap" style="text-align: center">
      <img src="{% static 'admin/simpleui-x/img/logo.svg' %}">
      <span style="font-size: medium; margin-left: 0; white-space: pre">{{ site_header }}</span>
    </div>
  </div>
{% endblock %}

{% block base_script %}
  {{ block.super }}
  <script>
    {# æ›¿æ›å·¦é‚Šé¸å–®çš„é¦–é åœ–ç¤º #}
    {# æ”¾åœ¨ script æœƒé–ƒçˆï¼Œä¸éæ”¾åœ¨ base_script ä¸æœƒ #}
    menus[0].icon = 'far fa-home'
    
    // ä¿®æ”¹é¦–é é€£çµ - ä½¿ç”¨å»¶é²åŸ·è¡Œç¢ºä¿ç”Ÿæ•ˆ
    setTimeout(function() {
      if (typeof menus !== 'undefined' && menus && menus[0]) {
        menus[0].url = '/admin/';
        menus[0].name = 'é¦–é ';
      }
    }, 100);
  </script>
{% endblock %}
